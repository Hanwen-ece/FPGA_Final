# Makefile for Vitis HLS Histogram Project

PROJECT_NAME = histogram_hls
TOP_FUNCTION = compute_histogram_axi_master
TCL_SCRIPT = run_hls.tcl

.PHONY: all project sim synth cosim export clean help

help:
	@echo "Available targets:"
	@echo "  make project  - Create HLS project"
	@echo "  make sim      - Run C Simulation"
	@echo "  make synth    - Run C Synthesis"
	@echo "  make cosim    - Run C/RTL Cosimulation"
	@echo "  make export   - Export IP"
	@echo "  make all      - Run full flow (sim + synth + export)"
	@echo "  make clean    - Clean project files"

all: sim synth export

project:
	vitis_hls -f $(TCL_SCRIPT) -tclargs create

sim:
	@echo "Running C Simulation..."
	vitis_hls -f $(TCL_SCRIPT) -tclargs sim

synth:
	@echo "Running C Synthesis..."
	vitis_hls -f $(TCL_SCRIPT) -tclargs synth

cosim:
	@echo "Running C/RTL Cosimulation..."
	vitis_hls -f $(TCL_SCRIPT) -tclargs cosim

export:
	@echo "Exporting IP..."
	vitis_hls -f $(TCL_SCRIPT) -tclargs export

clean:
	@echo "Cleaning project files..."
	rm -rf $(PROJECT_NAME).prj/
	rm -rf histogram_hls_ip/
	rm -f *.log
	rm -f vivado_*.log
	rm -f *.jou

# Interactive mode
interactive:
	vitis_hls -i
